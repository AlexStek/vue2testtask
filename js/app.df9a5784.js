(function(){"use strict";var t={4125:function(t,e,s){var i=s(7195),n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("InputsSection"),e("HistorySection")],1)},o=[],r=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"inputs"},[e("DebounceInput",{staticClass:"flex-item",attrs:{type:"text",id:"price",placeholder:"Цена"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),e("DebounceInput",{staticClass:"flex-item",attrs:{type:"text",id:"count",placeholder:"Количество"},model:{value:t.count,callback:function(e){t.count=e},expression:"count"}}),e("DebounceInput",{staticClass:"flex-item",attrs:{type:"text",id:"sum",placeholder:"Сумма"},model:{value:t.sum,callback:function(e){t.sum=e},expression:"sum"}}),e("button",{staticClass:"flex-item",attrs:{type:"button",disabled:t.disable},on:{click:t.saveData}},[t._v(" Отправить ")])],1),e("div",{staticClass:"labels"},[e("p",{staticClass:"flex-item"},[t._v("Цена: "+t._s(t.price))]),e("p",{staticClass:"flex-item"},[t._v("Количество: "+t._s(t.count))]),e("p",{staticClass:"flex-item"},[t._v("Сумма: "+t._s(t.sum))]),e("p",{staticClass:"flex-item"},[t._v(t._s(t.getLocalData))])])])},a=[],c=function(){var t=this,e=t._self._c;return e("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],attrs:{type:"text",id:t.id,placeholder:t.placeholder},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}})},u=[],l={name:"DebounceInput",props:{id:String,placeholder:String,value:[String,Number]},data(){return{timeout:null,debouncedInput:this.value}},watch:{value:function(){this.debouncedInput=this.value}},computed:{input:{get(){return this.debouncedInput},set(t){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.debouncedInput=t,this.$emit("input",t)}),300)}}}},h=l,p=s(1001),d=(0,p.Z)(h,c,u,!1,null,null,null),m=d.exports,f=s(408),v={name:"InputsSection",components:{DebounceInput:m},data(){return{price:0,count:0,sum:0,prevChangedField:"count",lastChangedField:"price",processing:!1,disable:!1}},methods:{async saveData(){if(this.disable)return;this.disable=!0;const t={price:this.price,qty:this.sum,amount:this.count};await this.$store.dispatch("saveToServer",t),this.disable=!1},updateChangeOrder(t){this.lastChangedField!==t&&(this.prevChangedField=this.lastChangedField,this.lastChangedField=t)}},watch:{price:function(){this.processing||(this.processing=!0,this.updateChangeOrder("price"),this.$store.dispatch("addToHistory",`Введена цена: ${this.price}`),"sum"===this.prevChangedField?(this.count=this.sum/this.price||0,this.$store.dispatch("addToHistory",`Количество пересчитано: ${this.count}`)):(this.sum=this.price*this.count||0,this.$store.dispatch("addToHistory",`Сумма пересчитана: ${this.sum}`)),i.ZP.nextTick((()=>{this.processing=!1})))},count:function(){this.processing||(this.processing=!0,this.updateChangeOrder("count"),this.$store.dispatch("addToHistory",`Введено количество: ${this.count}`),"sum"===this.prevChangedField?(this.price=this.sum/this.count||0,this.$store.dispatch("addToHistory",`Цена пересчитано: ${this.price}`)):(this.sum=this.price*this.count||0,this.$store.dispatch("addToHistory",`Сумма пересчитана: ${this.sum}`)),i.ZP.nextTick((()=>{this.processing=!1})))},sum:function(){this.processing||(this.processing=!0,this.updateChangeOrder("sum"),this.$store.dispatch("addToHistory",`Введена сумма: ${this.sum}`),"price"===this.prevChangedField?(this.count=this.sum/this.price||0,this.$store.dispatch("addToHistory",`Количество пересчитано: ${this.count}`)):(this.price=this.sum/this.count||0,this.$store.dispatch("addToHistory",`Цена пересчитано: ${this.price}`)),i.ZP.nextTick((()=>{this.processing=!1})))}},created(){const t=localStorage.getItem("data");this.localData=t},computed:{...(0,f.Se)(["getLocalData"])}},g=v,y=(0,p.Z)(g,r,a,!1,null,"78dd716e",null),b=y.exports,x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"history"},[e("h2",{staticClass:"title"},[t._v("История")]),e("div",t._l(t.historyReversed,(function(s,i){return e("p",{key:i},[t._v(t._s(s))])})),0)])},C=[],T={name:"HistorySection",props:{history:Array},computed:{...(0,f.Se)(["getHistory"]),historyReversed(){return[...this.getHistory].reverse()}}},_=T,$=(0,p.Z)(_,x,C,!1,null,"fc73197c",null),S=$.exports,H={name:"App",components:{InputsSection:b,HistorySection:S},data(){return{history:[]}}},O=H,w=(0,p.Z)(O,n,o,!1,null,null,null),D=w.exports;s(7658);i.ZP.use(f.ZP);const I=localStorage.getItem("data"),k=I?JSON.parse(I).nonce:0;var P=new f.ZP.Store({state:{nonce:k,history:[],localData:I||null},getters:{getHistory(t){return t.history},getLocalData(t){return t.localData}},mutations:{error(t,e){t.nonce++,e.nonce=t.nonce,t.history.push("Не удалось сохранить данные","Было отправлено: "+JSON.stringify(e))},save(t,e){e.nonce=t.nonce,t.nonce++;const s=t.localData,i=JSON.stringify(e);localStorage.setItem("data",i),t.localData=i,t.history.push("Данные сохраненны","До: "+s,"После: "+i)},addToHistory(t,e){t.history.push(e)}},actions:{addToHistory({commit:t},e){t("addToHistory",e)},async saveToServer({commit:t},e){return new Promise((s=>{setTimeout((()=>e.amount%2===0?(t("save",e),s({success:!0})):(t("error",e),s({success:!1}))),1e3)}))}}});i.ZP.config.productionTip=!1,new i.ZP({store:P,render:t=>t(D)}).$mount("#app")}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,i,n,o){if(!i){var r=1/0;for(l=0;l<t.length;l++){i=t[l][0],n=t[l][1],o=t[l][2];for(var a=!0,c=0;c<i.length;c++)(!1&o||r>=o)&&Object.keys(s.O).every((function(t){return s.O[t](i[c])}))?i.splice(c--,1):(a=!1,o<r&&(r=o));if(a){t.splice(l--,1);var u=n();void 0!==u&&(e=u)}}return e}o=o||0;for(var l=t.length;l>0&&t[l-1][2]>o;l--)t[l]=t[l-1];t[l]=[i,n,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var n,o,r=i[0],a=i[1],c=i[2],u=0;if(r.some((function(e){return 0!==t[e]}))){for(n in a)s.o(a,n)&&(s.m[n]=a[n]);if(c)var l=c(s)}for(e&&e(i);u<r.length;u++)o=r[u],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(l)},i=self["webpackChunkvue2test"]=self["webpackChunkvue2test"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(4125)}));i=s.O(i)})();
//# sourceMappingURL=app.df9a5784.js.map